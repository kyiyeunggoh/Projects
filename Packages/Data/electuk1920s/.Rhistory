read_rds(file.choose(.))
#The most number of votes won by a candidate was 101 550 votes.
read_rds(file.choose("/Users/pyeungyeung/Desktop/electuk1920s/data/election1920sdb.rda"))
library(rvest)
library(plyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(stringr)
library(xml2)
library(httr)
library(data.table)
library(XML)
library(httr)
library(rebus)
library(RJSONIO)
library(googleway)
library(gtools)
library(ggmap)
library(foreach)
library(reshape)
# Creating loop to extract 1922 data
datalist=list()
for (i in 2:261) {
url<-"https://en.wikipedia.org/wiki/Constituency_election_results_in_the_1922_United_Kingdom_general_election"
wiki<- read_html(url)
wiki<-read_html(url)
table<-html_nodes(wiki,css=".wikitable")[i]
pagename_head<-'//*[@id="mw-content-text"]/div/table/caption'
pagename_year<-'//*[@id="firstHeading"]'
table_head<-html_nodes(wiki,xpath=pagename_head)[i]
table_year<-html_nodes(wiki,xpath=pagename_year)
results<-(html_table(table, fill=TRUE))[[1]]
constituency<-as.character(str_extract(html_text(table_head), "^[a-zA-Z]+"))
year<-as.numeric(str_extract(html_text(table_year), "(\\d)+"))
results['Constituency']=constituency
results['Year']=year
datalist[[i]]<-results
}
election_1922= do.call(rbind, datalist)
# Creating loop to extract 1923 data
datalist1=list()
for (i in 2:588) {
url<-"https://en.wikipedia.org/wiki/Constituency_election_results_in_the_1923_United_Kingdom_general_election"
wiki<-read_html(url)
table<-html_nodes(wiki,css=".wikitable")[i]
pagename_head<-'//*[@id="mw-content-text"]/div/table/caption'
pagename_year<-'//*[@id="firstHeading"]'
table_head<-html_nodes(wiki,xpath=pagename_head)[i]
table_year<-html_nodes(wiki,xpath=pagename_year)
results<-(html_table(table, fill=TRUE))[[1]]
constituency<-as.character(str_extract(html_text(table_head), "^[a-zA-Z]+"))
year<-as.numeric(str_extract(html_text(table_year), "(\\d)+"))
results['Constituency']=constituency
results['Year']=year
datalist1[[i]]<-results
}
election_1923= do.call(rbind, datalist1)
# Creating loop to extract 1929 data
datalist2=list()
for (i in 2:588) {
url<-"https://en.wikipedia.org/wiki/Constituency_election_results_in_the_1929_United_Kingdom_general_election"
wiki<-read_html(url)
table<-html_nodes(wiki,css=".wikitable")[i]
pagename_head<-'//*[@id="mw-content-text"]/div/table/caption'
pagename_year<-'//*[@id="firstHeading"]'
table_head<-html_nodes(wiki,xpath=pagename_head)[i]
table_year<-html_nodes(wiki,xpath=pagename_year)
results<-(html_table(table, fill=TRUE))[[1]]
constituency<-as.character(str_extract(html_text(table_head), "^[a-zA-Z]+"))
year<-as.numeric(str_extract(html_text(table_year), "(\\d)+"))
results['Constituency']=constituency
results['Year']=year
datalist2[[i]]<-results
}
election_1929= rbindlist(datalist2, fill=TRUE)
election_1929<-subset(election_1929, select=c(1:8))%>%
as.data.frame(.)
##NOTE: Function can be written but much faster to extract given that the structure of each page is different
##Hence, manual inspection of the xpaths are needed. I start at 2 because 1 is blank and end at 588 before
##data on university elections which are not relevant for our project. However, data from our second source,
##is far more amenable to extraction via a function and I have created one after testing it on a loop.
# Unfilled data from politics resources (1924 onwards) - for 1 page [TRIAL USING A FOR LOOP]
datalist3<-list()
for (i in 1:length(numlist)){
url_rem<-"http://www.politicsresources.net/area/uk/ge1924/i01.html"
remwiki<-read_html(url_rem)
numlist<-html_nodes(remwiki, css=".inner")%>%
as.list(.)
tablerem<-html_nodes(remwiki, css=".inner")[i]
pagename_head<-html_nodes(remwiki,css=".constname")[i]
table_year<-as.numeric(str_extract(html_text(remwiki,'/html/body/h1'),"(\\d)+"))
results<-as.data.frame(html_table(tablerem, fill=TRUE))
constituency<-html_text(pagename_head)
year<-table_year
results["Constituency"]=as.character(constituency)
results['Year']=as.numeric(year)
results
datalist3[[i]]<-results
}
# Function to extract based on URL rather than manually keying 14 times of those pages for this website
polres_scrape<-function(url){
library(tidyverse)
library(stringr)
library(rvest)
listofdata<-list()
numlist<-read_html(url)%>%
html_nodes(.,css=".inner")%>%
as.list(.)
for (i in 1:length(numlist)) {
remwiki<-read_html(url)
tablerem<-html_nodes(remwiki, css=".inner")[i]
pagename_head<-html_nodes(remwiki,css=".constname")[i]
table_year<-as.numeric(str_extract(html_text(remwiki,'/html/body/h1'),"(\\d)+"))
results<-as.data.frame(html_table(tablerem, fill=TRUE))
constituency<-html_text(pagename_head)
year<-table_year
results["Constituency"]=as.character(constituency)
results['Year']=as.numeric(year)
results
listofdata[[i]]<-results
}
return(listofdata)
}
d1<-polres_scrape("http://www.politicsresources.net/area/uk/ge1924/i01.html")
d2<-polres_scrape("http://www.politicsresources.net/area/uk/ge1924/i02.html")
d3<-polres_scrape("http://www.politicsresources.net/area/uk/ge1924/i03.html")
d4<-polres_scrape("http://www.politicsresources.net/area/uk/ge1924/i04.html")
devtools::use_data(election1920sdb)
usethis::use_data(election1920sdb)
devtools::use_data(election1920sdb)
election1920sdb <- readRDS("~/Desktop/electuk1920s/data/election1920sdb.rds")
View(election1920sdb)
??electuk1920s
??get_latlong
devtools::use_vignette("my-vignette")
use_readme_rmd()
devtools::use_data(election1920sdb)
devtools::document()
library(testthat)
library(roxygen2)
library(devtools)
has_devel()
has_devel(TRUE)
devtools::load_all()
devtools::load_all()
usethis::use_package(rvest)
usethis::use_package("rvest")
usethis::use_package("xml2")
devtools::load_all()
url<-"https://en.wikipedia.org/wiki/Constituency_election_results_in_the_1922_United_Kingdom_general_election"
wiki<-read_html(url)
library(rvest)
library(xml2)
wiki<-read_html(url)
wiki<-html(url)
wiki<-read_html(url)
library(rvest)
library(plyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(stringr)
library(xml2)
library(httr)
library(data.table)
library(XML)
library(httr)
library(rebus)
library(RJSONIO)
library(googleway)
library(gtools)
library(ggmap)
library(foreach)
library(reshape)
devtools::load_all()
`overwrite = TRUE`
overwrite = TRUE
devtools::load_all()
library(rvest)
library(plyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(stringr)
library(xml2)
library(httr)
library(data.table)
library(XML)
library(httr)
library(rebus)
library(RJSONIO)
library(googleway)
library(gtools)
library(ggmap)
library(foreach)
library(reshape)
devtools::load_all()
st
devtools::document()
library(rvest)
library(plyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(stringr)
library(xml2)
library(httr)
library(data.table)
library(XML)
library(httr)
library(rebus)
library(RJSONIO)
library(googleway)
library(gtools)
library(ggmap)
library(foreach)
library(reshape)
devtools::load_all(".")
install.packages("electuk1920s")
devtools::document()
library(rvest)
library(plyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(stringr)
library(xml2)
library(httr)
library(data.table)
library(XML)
library(httr)
library(rebus)
library(RJSONIO)
library(googleway)
library(gtools)
library(ggmap)
library(foreach)
library(reshape)
devtools::document()
??get_latlong
??polres_scrape
??electuk1920s
??get_latlong
election1920sdb <- readRDS("~/Desktop/electuk1920s/data/election1920sdb.rds")
View(election1920sdb)
library(electuk1920s)
library(electuk1920s)
library(devtools)
library(roxygen2)
library(testthat)
library(rvest)
library(plyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(stringr)
library(xml2)
library(httr)
library(data.table)
library(XML)
library(httr)
library(rebus)
library(RJSONIO)
library(googleway)
library(gtools)
library(ggmap)
library(foreach)
library(reshape)
library(devtools)
library(roxygen2)
library(testthat)
library(rvest)
library(plyr)
library(dplyr)
library(tidyverse)
library(stringr)
library(xml2)
library(httr)
library(data.table)
library(XML)
library(httr)
library(rebus)
library(RJSONIO)
library(foreach)
library(reshape)
library(electuk1920s)
election1920sdb <- readRDS("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s/election1920sdb.rds")
View(election1920sdb)
election1920sdb <- readRDS("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s/data/election1920sdb.rds")
View(election1920sdb)
load("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s/data/election1920sdb.rda")
election1920sdb<-readRDS("election1920sdb")
election1920sdb <- readRDS("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s/data/election1920sdb.rds")
View(election1920sdb)
devtools::install_github("iriszy/hkpopr")
library(hkpopr)
mydata <- hkpop("https://www.hkupop.hku.hk/english/popexpress/sargperf/econ/halfyr/datatables.html")
View(mydata)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
election1920sdb <- readRDS("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s/data/election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
election1920sdb<-usethis::use_data("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
election1920sdb<-usethis::use_data(election1920sdb)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds('election1920sdb.rds')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds('election1920sdb.rda')
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds('election1920sdb.rds')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds(election1920sdb.rds)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds(election1920sdb.rds)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-readRDS("election1920sdb.rds")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds("election1920sdb")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s")
library(tidyverse)
library(dplyr)
library(stringr)
library(rebus)
library(data.table)
library(readr)
election1920sdb<-read_rds("election1920sdb.rds")
election1920sdb <- readRDS("~/Downloads/Goh_KyiYeung/Final Project/electuk1920s/election1920sdb.rds")
View(election1920sdb)
